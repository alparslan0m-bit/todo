/* ========================================
   APPLE NATIVE DESIGN SYSTEM (iOS 17/18)
   ======================================== */

@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap');
@import 'tailwindcss/base';
@import 'tailwindcss/components';
@import 'tailwindcss/utilities';

:root {
  /* System Colors - Updated to Islamic Palette */
  --primary: #059669;
  /* Rich Emerald (Traditional Green) */
  --secondary: #0D9488;
  /* Deep Teal (Persian Blue/Green) */
  --success: #15803D;
  /* Dark Green */
  --danger: #DC2626;
  /* Deep Red */
  --warning: #D97706;
  /* Amber/Gold */

  /* System Backgrounds */
  --bg-system: #F2F4F3;
  /* Very subtle warm greenish-gray tint */
  --bg-content: #FFFFFF;
  --bg-grouped: #FFFFFF;

  /* Text Colors - Authentic Islamic Typography Palette */
  --text-main: #062C24;
  /* Deepest possible Pine Green (Replacing Black) */
  --text-secondary: #4A635D;
  /* Slate Sage Green */
  --text-tertiary: #9CA3AF;

  /* Materials */
  --border-light: rgba(6, 44, 36, 0.08);
  --glass-bg: rgba(255, 255, 255, 0.7);

  /* Easing */
  --spring-easing: cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

* {
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
  outline: none;
}

html {
  /* Full height for proper viewport */
  height: 100%;
  /* CRITICAL: Allow content to scroll naturally */
  overflow: visible;
}

body {
  margin: 0;
  padding: 0;
  font-family: 'Cairo', -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", "Helvetica Neue", Arial, sans-serif;
  background-color: var(--bg-system);
  color: var(--text-main);
  line-height: 1.4;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  direction: rtl;
  user-select: none;
  -webkit-user-select: none;
  height: 100%;
  /* CRITICAL: Prevent body scroll and pull-to-refresh */
  overflow: hidden;
  overscroll-behavior-y: none;
  position: fixed;
  width: 100%;
}

/* üì± Native Viewport Architecture - Apple-style Scroll Container */
.app-viewport {
  position: fixed;
  inset: 0;
  /* CRITICAL: Don't block scroll propagation */
  overflow: visible;
  display: flex;
  flex-direction: column;
  background-color: var(--bg-system);
}

/* üçé THE SINGLE SCROLL CONTAINER - All scrolling happens here */
.page-wrapper {
  position: relative;
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  /* iOS momentum scrolling - the magic sauce */
  -webkit-overflow-scrolling: touch;
  /* CRITICAL: Contain scroll to prevent pull-to-refresh but allow bounce */
  overscroll-behavior-y: contain;
  /* Hardware acceleration for 60fps scrolling */
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  will-change: scroll-position;
  /* Smooth scroll for programmatic scrolling only */
  scroll-behavior: smooth;
}

/* üßä iOS Glassmorphism Materials */
.apple-glass {
  background-color: var(--glass-bg);
  backdrop-filter: saturate(180%) blur(20px);
  -webkit-backdrop-filter: saturate(180%) blur(20px);
}

/* üßº Clean Grouped List Style */
.grouped-section {
  background-color: var(--bg-grouped);
  border-radius: 12px;
  overflow: hidden;
  margin: 0 16px 24px;
  border: 0.5px solid var(--border-light);
}

/* ‚å®Ô∏è Keyboard-Friendly Padding */
.pb-keyboard {
  padding-bottom: env(safe-area-inset-bottom);
}

/* üö´ Scrollbar-Free Experience */
.no-scrollbar::-webkit-scrollbar {
  display: none;
}

.no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* ‚ú® Typography Polish */
h1,
h2,
h3 {
  letter-spacing: -0.02em;
}

.large-title {
  font-size: 34px;
  font-weight: 700;
  line-height: 41px;
}

.headline {
  font-size: 17px;
  font-weight: 600;
  line-height: 22px;
}

.subheadline {
  font-size: 15px;
  font-weight: 400;
  line-height: 20px;
  color: var(--text-secondary);
}

/* üëÜ Tactile Interactions */
.active-scale:active {
  transform: scale(0.96);
  transition: transform 0.1s ease-out;
}

.active-opacity:active {
  opacity: 0.5;
  transition: opacity 0.1s ease-out;
}

/* üåà Animation Primitives */
@keyframes ios-reveal {
  from {
    opacity: 0;
    transform: translateY(10px) scale(0.98);
  }

  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.animate-reveal {
  animation: ios-reveal 0.4s cubic-bezier(0.1, 0.7, 0.1, 1);
}

/* üçé Apple Native Scroll Behavior */
/* Horizontal momentum scroll with snap for category filters */
.scroll-snap-x {
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
  overflow-x: auto;
  overscroll-behavior-x: contain;
}

.scroll-snap-x>* {
  scroll-snap-align: start;
}

/* Ensure smooth momentum and bounce on all scrollable areas */
[class*="overflow-y-auto"],
[class*="overflow-x-auto"] {
  -webkit-overflow-scrolling: touch;
}

/* Improved scroll container with native feel */
.native-scroll {
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-y: auto;
  scroll-behavior: smooth;
  /* Use hardware acceleration for smoother scrolling */
  will-change: scroll-position;
  transform: translateZ(0);
}

/* Horizontal scroll with fade mask - Apple style */
.mask-gradient-right {
  mask-image: linear-gradient(to left, transparent 0%, black 10%, black 100%);
  -webkit-mask-image: linear-gradient(to left, transparent 0%, black 10%, black 100%);
}

/* Prevent content from shifting during bounce */
.scroll-stable {
  overflow-anchor: auto;
}

/* iOS-style spring physics for interactive elements */
.spring-press {
  transition: transform 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.spring-press:active {
  transform: scale(0.97);
}

/* Smooth vertical scroll with inertia */
@supports (-webkit-touch-callout: none) {

  /* iOS-specific optimizations */
  .page-wrapper {
    /* Enhanced iOS momentum scrolling */
    -webkit-overflow-scrolling: touch;
  }

  /* Prevent rubber-band on fixed elements */
  .sticky {
    position: -webkit-sticky;
    position: sticky;
  }
}

/* Ensure root element allows native bounce */
#root {
  height: 100%;
  /* CRITICAL: Don't block bounce - let page-wrapper handle all scrolling */
  overflow: visible;
}

/* üçé Apple Elastic Bounce Enhancement */
/* Add extra padding at bottom to allow visible bounce */
.bounce-padding {
  padding-bottom: 60px;
}

/* Prevent double-scroll on nested elements */
.scroll-child {
  overflow: visible !important;
  min-height: auto !important;
}

/* iOS Rubber-band visual enhancement */
@supports (-webkit-touch-callout: none) {

  /* iOS only: ensure smooth deceleration curve */
  .page-wrapper {
    scroll-snap-type: none;
    /* Don't snap during bounce */
  }
}

/* üì± iOS Standalone PWA - Disable Pull-to-Refresh, Keep Rubber Band */
@media all and (display-mode: standalone) {

  html,
  body {
    /* Fixed positioning prevents pull-to-refresh navigation */
    position: fixed;
    overflow: hidden;
    width: 100%;
    height: 100%;
    /* Absolutely no overscroll on body level */
    overscroll-behavior: none;
  }

  #root {
    position: fixed;
    inset: 0;
    overflow: hidden;
  }

  .app-viewport {
    position: fixed;
    inset: 0;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  /* The page-wrapper is the ONLY element that scrolls */
  /* Keep it in flex flow - don't use position: absolute */
  .page-wrapper {
    flex: 1;
    min-height: 0;
    /* Critical for flex scroll containers */
    overflow-y: auto;
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    /* contain = allow rubber band bounce but block pull-to-refresh navigation */
    overscroll-behavior-y: contain;
    /* Ensure proper touch handling */
    touch-action: pan-y;
  }
}

/* Also target iOS Safari standalone via class (added by JS) */
html.standalone-pwa,
html.standalone-pwa body {
  position: fixed;
  overflow: hidden;
  width: 100%;
  height: 100%;
  overscroll-behavior: none;
}

html.standalone-pwa #root {
  position: fixed;
  inset: 0;
  overflow: hidden;
}

html.standalone-pwa .page-wrapper {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-y: contain;
  touch-action: pan-y;
}